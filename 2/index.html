<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 2</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./style.css">
    <!-- highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
</head>

<body>
    <!-- <div class="parallax-bg"></div> -->
    <header>
        <h1 style="color:#3a7bd5; font-family: 'Montserrat', sans-serif; font-size: 72px;">Project 2</h1>
        <p style="color:#2f2f2f; font-size: 30px;">Fun with Filters and Frequencies!
        </p>
    </header>
    <div class="main-content-area">
        <section style="margin-bottom: 2.5rem;">
            <h2 style="color:#2a5db0; text-align:center; margin-bottom:1.2rem; letter-spacing:1px; font-size:2.1rem;">
                Part 1: Fun with Filters</h2>
            <div
                style="color:#2d3540; font-size:1.13rem; max-width:900px; margin:0 auto 2.2rem auto; line-height:1.85; background:linear-gradient(90deg,#fafdff 60%,#eaf1fa 100%); border-radius:18px; padding:1.5rem 2.2rem; box-shadow:0 4px 24px rgba(58,123,213,0.10); border-left:6px solid #3a7bd5;">
                <div style="margin-bottom:1.5em;">
                    <span style="font-weight:600; color:#3a7bd5;">Part 1.1: Convolutions from Scratch!</span><br>
                    <span style="color:#444;">Write a convolution function of 4 loops and 2 loops
                        from scratch. Compare them with the scipy.</span>
                    <div class="vb"> 4 loops
                        <div class=" hb">
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/boxFilter_4loop.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">box filter</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/dx_4loop.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">dx</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/dy_4loop.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">dy</div>
                            </div>
                        </div>
                    </div>
                    <div class="vb"> 2 loops
                        <div class=" hb">
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/boxFilter_2loop.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">box filter</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/dx_2loop.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">dx</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/dy_2loop.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">dy</div>
                            </div>
                        </div>
                    </div>
                    <div class="vb"> scipy
                        <div class=" hb">
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/boxFilter_scipy.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">box filter</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/dx_scipy.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">dx</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/dy_scipy.jpg" alt="4-loops"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">dy</div>
                            </div>
                        </div>
                    </div>

                    <details style="margin-top:0.7em;">
                        <summary
                            style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                            Show Code</summary>
                        <pre
                            style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                                <code class="language-python">
def conv_4loop(img, kernel):
    h, w = img.shape
    kh, kw = kernel.shape
    output = np.zeros((h, w), dtype=np.float32)
    for i in range(h):
        for j in range(w):
            acc = 0
            for ki in range(-(kh//2), kh//2 + 1):
                for kj in range(-(kw//2), kw//2 + 1):
                    if 0 <= i + ki < h and 0 <= j + kj < w:
                        acc += img[i + ki, j + kj] * kernel[ki + kh//2, kj + kw//2]
            output[i, j] = acc
    normalized = cv2.normalize(output, None, 0, 255, cv2.NORM_MINMAX)
    return normalized

def conv_2loop(img, kernel):
    h, w = img.shape
    kh, kw = kernel.shape
    pad_img = np.pad(img, ((kh//2, kh//2), (kw//2, kw//2)), 'constant')
    output = np.zeros((h, w), dtype=np.float32)
    for i in range(h):
        for j in range(w):
            output[i, j] = np.sum(pad_img[i:i+kh, j:j+kw] * kernel)
    normalized = cv2.normalize(output, None, 0, 255, cv2.NORM_MINMAX)
    return normalized</code>
                    </pre>
                    </details>
                    <div style="margin-bottom:1.5em;">
                        <span style="font-weight:600; color:#3a7bd5;">Part 1.2: Finite Difference Operator</span><br>
                        <span style="color:#444;">Show partial derivatives in x and y, the gradient magnitude image, and
                            a binarized edge image.</span>
                        <div class="vb">
                            <div class="hb">
                                <div style="text-align:center; width: 30%;">
                                    <img src="./code/results/cameraman_dx.jpg" alt="dx"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">Partial derivative in x</div>
                                </div>
                                <div style="text-align:center; width: 30%;">
                                    <img src="./code/results/cameraman_dy.jpg" alt="dy"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">Partial derivative in y</div>
                                </div>
                                <div style="text-align:center; width: 30%;">
                                    <img src="./code/results/cameraman_edge.jpg" alt="edge"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">Gradient magnitude and binarized edge</div>
                                </div>
                            </div>
                        </div>

                        <details style="margin-top:0.7em;">
                            <summary
                                style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                                Show Code</summary>
                            <pre
                                style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                        <code class="language-python">
gaussian_kernel = cv2.getGaussianKernel(ksize=5, sigma=1)
gaussian_kernel = gaussian_kernel @ gaussian_kernel.T

blurred_img = signal.convolve2d(img, gaussian_kernel, mode='same', boundary='fill', fillvalue=0)

dxImg = signal.convolve2d(blurred_img, dxFilter, mode='same', boundary='fill', fillvalue=0)
dyImg = signal.convolve2d(blurred_img, dyFilter, mode='same', boundary='fill', fillvalue=0)

gradient_magnitude = np.sqrt(dxImg**2 + dyImg**2)
gradient_magnitude = cv2.normalize(gradient_magnitude, None, 0, 255, cv2.NORM_MINMAX)

edge_threshold = 65
_, edge = cv2.threshold(gradient_magnitude, edge_threshold, 255, cv2.THRESH_BINARY)

cv2.imwrite("./results/cameraman_edge_blurred.jpg", edge)
plt.imshow(gradient_magnitude, cmap='gray')
plt.show()
plt.imshow(edge, cmap='gray')
plt.show()</code>
                    </pre>
                        </details>
                    </div>

                    <div style="margin-bottom:1.5em;">
                        <span style="font-weight:600; color:#3a7bd5;">Part 1.3: Derivative of Gaussian (DoG)
                            Filter</span><br>
                        <span style="color:#444;">Compare the results with just the difference operator (noisy) with the
                            DoG filter. Create DoG filters by convolving the gaussian with D_x and D_y.</span>
                        <div class="vb">
                            <div class="hb">
                                <div style="text-align:center; width: 30%;">
                                    <img src="./code/results/cameraman_edge.jpg" alt="edge"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">Edge with finite difference (noisy)</div>
                                </div>
                                <div style="text-align:center; width: 30%;">
                                    <img src="./code/results/cameraman_edge_blurred.jpg" alt="blurred"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">Blurred image with Gaussian</div>
                                </div>
                                <div style="text-align:center; width: 30%;">
                                    <img src="./code/results/cameraman_edge_DoG.jpg" alt="DoG"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">Edge with DoG filter</div>
                                </div>
                            </div>
                        </div>

                        <div class="vb">
                            <div class="hb">
                                <div style="text-align:center; width: 40%;">
                                    <img src="./code/results/DoG_x_kernel.jpg" alt="DoG_x"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">DoG kernel in x direction</div>
                                </div>
                                <div style="text-align:center; width: 40%;">
                                    <img src="./code/results/DoG_y_kernel.jpg" alt="DoG_y"
                                        style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                    <div style="margin-top: 0;color:#555;">DoG kernel in y direction</div>
                                </div>
                            </div>
                        </div>
                        <div class="vb">
                            <div style="text-align:center; width: 200%;">
                                <img src="./code/results/DoG_filters_3D.png" alt="DoG_3D"
                                    style="max-width:320px; width:200%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">3D visualization of DoG kernels</div>
                            </div>
                        </div>

                        <div style="margin-top: 1em;">
                            <p><strong>Answer the questions:</strong></p>
                            <p><strong>What is the difference between the results obtained using the finite difference
                                    operator and the DoG filter?</strong></p>
                            <p>As can be seen from the images, the edges detected using the finite difference operator
                                (left image) contain a lot of noise, the edges are not clear, and there are many small
                                noise points. The edges detected using the DoG filter (right image) are smoother and
                                clearer, most of the noise has been removed, and the edge lines are more continuous and
                                distinct. This is because the DoG filter first smooths the image with a Gaussian filter
                                before calculating the gradient, which effectively suppresses the influence of noise.
                            </p>

                            <p><strong>Why does the DoG filter produce better results?</strong></p>
                            <p>The DoG (Difference of Gaussian) filter can achieve better edge detection results for the
                                following main reasons:</p>
                            <ol>
                                <li><strong>Noise suppression</strong>: The DoG filter first smooths the image using a
                                    Gaussian kernel, effectively removing noise from the image, while the finite
                                    difference operator directly calculates the gradient on the original image, which is
                                    easily disturbed by noise.</li>
                                <li><strong>Edge enhancement</strong>: Through Gaussian filtering, the edges in the
                                    image become smoother and more continuous, and clearer edge responses can be
                                    obtained when calculating the gradient again.</li>
                                <li><strong>Biological vision inspiration</strong>: The DoG filter simulates the
                                    mechanism of edge detection in the human visual system, which is more in line with
                                    the way the human eye perceives edges.</li>
                            </ol>

                            <p><strong>What is the difference between blurring and then computing the gradient and
                                    computing the gradient using the DoG kernel?</strong></p>
                            <p>Although both methods theoretically produce the same result, there are practical
                                differences:</p>
                            <ol>
                                <li><strong>Computational efficiency</strong>: Computing the gradient using the DoG
                                    kernel is more efficient as it requires only one convolution operation, while
                                    blurring and then computing the gradient requires two separate operations.</li>
                                <li><strong>Numerical precision</strong>: Using the DoG kernel can reduce accumulated
                                    numerical errors that might occur in the two-step process.</li>
                                <li><strong>Implementation clarity</strong>: Blurring first and then computing the
                                    gradient is more intuitive and easier to understand, while using the DoG kernel is
                                    more abstract but mathematically elegant.</li>
                            </ol>
                        </div>

                        <details style="margin-top:0.7em;">
                            <summary
                                style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                                Show Code</summary>
                            <pre
                                style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                        <code class="language-python">
gaussian_kernel = cv2.getGaussianKernel(ksize=5, sigma=1)
gaussian_kernel = gaussian_kernel @ gaussian_kernel.T

blurred_img = signal.convolve2d(img, gaussian_kernel, mode='same', boundary='fill', fillvalue=0)

dxImg = signal.convolve2d(blurred_img, dxFilter, mode='same', boundary='fill', fillvalue=0)
dyImg = signal.convolve2d(blurred_img, dyFilter, mode='same', boundary='fill', fillvalue=0)

gradient_magnitude = np.sqrt(dxImg**2 + dyImg**2)
gradient_magnitude = cv2.normalize(gradient_magnitude, None, 0, 255, cv2.NORM_MINMAX)

edge_threshold = 65
_, edge = cv2.threshold(gradient_magnitude, edge_threshold, 255, cv2.THRESH_BINARY)

gaussian_kernel = cv2.getGaussianKernel(ksize=5, sigma=1)
gaussian_kernel = gaussian_kernel @ gaussian_kernel.T

DoG_x_kernel = signal.convolve2d(gaussian_kernel, dxFilter, mode='same', boundary='fill', fillvalue=0)
DoG_y_kernel = signal.convolve2d(gaussian_kernel, dyFilter, mode='same', boundary='fill', fillvalue=0)

grad_x = signal.convolve2d(img, DoG_x_kernel, mode='same', boundary='fill', fillvalue=0)
grad_y = signal.convolve2d(img, DoG_y_kernel, mode='same', boundary='fill', fillvalue=0)
DoG_img = np.sqrt(grad_x**2 + grad_y**2)
DoG_img = cv2.normalize(DoG_img, None, 0, 255, cv2.NORM_MINMAX)
plt.imshow(DoG_img, cmap='gray')
plt.show()

edge_DoG = cv2.threshold(DoG_img, 65, 255, cv2.THRESH_BINARY)[1]
cv2.imwrite("./results/cameraman_edge_DoG.jpg", edge_DoG)

</code>
                    </pre>
                        </details>
                    </div>
                </div>
                <div style="margin-bottom:1.5em;">
                    <span style="font-weight:600; color:#3a7bd5;">Gradient Orientation
                        Visualization</span><br>
                    <span style="color:#444;">Compute the image gradient orientations, and visualize it with HSV color
                        space!</span>
                    <p style="margin-top: 1em; color: #555;">
                        To visualize gradient orientations, we use the HSV color space where:
                    <ul style="margin-top: 0.5em; color: #555;">
                        <li>Hue represents the gradient orientation (0° to 360° mapped to 0-180 in OpenCV)</li>
                        <li>Saturation is set to maximum to have vivid colors</li>
                        <li>Value is set based on gradient magnitude to show strong gradients more clearly</li>
                    </ul>
                    </p>
                    <div class="vb">
                        <div class="hb">
                            <div style="text-align:center; width: 80%;">
                                <img src="./code/results/gradient_orientation.png" alt="cameraman_orient_hsv"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Gradient Orientation Visualization (HSV)</div>
                            </div>
                        </div>
                    </div>
                    <p style="margin-top: 1em; color: #555;">
                        In this visualization, different colors represent different gradient orientations.
                        Red typically represents horizontal gradients (0°), green represents 120°, and blue represents
                        240°.
                        The intensity of the color corresponds to the magnitude of the gradient at that point.
                        This provides an intuitive way to understand the distribution of edge directions in the image.
                    </p>
                    <details style="margin-top:0.7em;">
                        <summary
                            style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                            Show Code</summary>
                        <pre
                            style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                                <code class="language-python">
orientation = np.arctan2(dyImg, dxImg)

hue = (orientation + np.pi) / (2 * np.pi)

saturation = np.ones_like(hue)

value = cv2.normalize(gradient_magnitude, None, 0, 1, cv2.NORM_MINMAX)

hsv_image = np.stack([hue, saturation, value], axis=-1)

from matplotlib.colors import hsv_to_rgb
rgb_image = hsv_to_rgb(hsv_image)
                </code>
                    </pre>
                    </details>
                </div>
        </section>



        <section style="margin-bottom: 2.5rem;">
            <h2 style="color:#2a5db0; text-align:center; margin-bottom:1.2rem; letter-spacing:1px; font-size:2.1rem;">
                Part 2: Fun with Frequencies!</h2>
            <div
                style="color:#2d3540; font-size:1.13rem; max-width:900px; margin:0 auto 2.2rem auto; line-height:1.85; background:linear-gradient(90deg,#fafdff 60%,#eaf1fa 100%); border-radius:18px; padding:1.5rem 2.2rem; box-shadow:0 4px 24px rgba(58,123,213,0.10); border-left:6px solid #3a7bd5;">
                <div style="margin-bottom:1.5em;">
                    <span style="font-weight:600; color:#3a7bd5;">Part 2.1: Image "Sharpening"</span><br>
                    <span style="color:#444;">Use a single kernel to sharpen the image. Just need to let 2 impulse
                        filters minus the Gaussian filter.</span>
                    <div class="vb">
                        <div class="hb">
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/taj.jpg" alt="taj_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Taj Mahal original</div>
                            </div>
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/taj_sharpened.jpg" alt="taj_sharpened"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Taj Mahal sharpened</div>
                            </div>
                        </div>
                        <div class="hb">
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/Chihaya Anon.png" alt="anon_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Chihaya Anon original</div>
                            </div>
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/Chihaya_Anon_sharpened.jpg" alt="anon_sharpened"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Chihaya Anon sharpened</div>
                            </div>
                        </div>
                    </div>

                    <details style="margin-top:0.7em;">
                        <summary
                            style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                            Show Code</summary>
                        <pre
                            style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                            <code class="language-python">
# Create sharpening kernel
gaussian_kernel = cv2.getGaussianKernel(ksize=13, sigma=4)
gaussian_kernel = gaussian_kernel @ gaussian_kernel.T

kernel = np.zeros((13, 13), dtype=np.float32)
kernel[6, 6] = 2.0
kernel -= gaussian_kernel

def sharpen_img(img):
    sharpened_img = np.zeros_like(img, dtype=np.float32)
    for c in range(img.shape[2]):
        sharpened_img[:, :, c] = signal.convolve2d(img[:, :, c], kernel, mode='same', boundary='fill', fillvalue=0)
    sharpened_img = np.clip(sharpened_img, 0, 255).astype(np.uint8)
    return sharpened_img

# Sharpen the images
taj_img = cv2.imread('./imgs/taj.jpeg')
taj_sharpened = sharpen_img(taj_img)
cv2.imwrite('./results/taj_sharpened.jpg', taj_sharpened)

chihaya_img = cv2.imread('./imgs/Chihaya_Anon.png')
chihaya_sharpened = sharpen_img(chihaya_img)
cv2.imwrite('./results/Chihaya_Anon_sharpened.jpg', chihaya_sharpened)

plt.imshow(cv2.cvtColor(taj_sharpened, cv2.COLOR_BGR2RGB))
plt.show()
plt.imshow(cv2.cvtColor(chihaya_sharpened, cv2.COLOR_BGR2RGB))
plt.show()</code>
                        </pre>
                    </details>
                </div>

                <div style="margin-bottom:1.5em;">
                    <span style="font-weight:600; color:#3a7bd5;">Part 2.2: Hybrid Images</span><br>
                    <span style="color:#444;">Create hybrid images using the approach described in the SIGGRAPH 2006
                        paper by Oliva, Torralba, and Schyns.</span>
                    <p style="margin-top: 1em; color: #555;">
                        Hybrid images are static images that change in interpretation as a function of the viewing
                        distance.
                        The process involves combining the low-frequency content of one image with the high-frequency
                        content
                        of another to create a single image that can be perceived as either image depending on the
                        viewing distance.
                    </p>
                    <div class="vb">
                        <div class="hb">
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/filtered1_sakiko.jpg" alt="sakiko_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Sakiko original</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/filtered2_mutsumi.jpg" alt="mutsumi_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Mutsumi original</div>
                            </div>
                            <div style="text-align:center; width: 30%;">
                                <img src="./code/results/hybrid_sakiko_mutsumi.jpg" alt="hybrid_image"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Hybrid image</div>
                            </div>
                        </div>
                    </div>
                    <div class="vb">
                        <h3>Frequency Analysis</h3>
                        <div class="hb">
                            <div style="text-align:center; width: 23%;">
                                <img src="./code/results/fft1.jpg" alt="sakiko_fft"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Sakiko FFT</div>
                            </div>
                            <div style="text-align:center; width: 23%;">
                                <img src="./code/results/fft1_filtered.jpg" alt="sakiko_lowpass_fft"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Sakiko low-pass FFT</div>
                            </div>
                            <div style="text-align:center; width: 23%;">
                                <img src="./code/results/fft2.jpg" alt="mutsumi_fft"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Mutsumi FFT</div>
                            </div>
                            <div style="text-align:center; width: 23%;">
                                <img src="./code/results/fft2_filtered.jpg" alt="mutsumi_highpass_fft"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Mutsumi high-pass FFT</div>
                            </div>
                        </div>
                        <div class="hb">
                            <div style="text-align:center; width: 100%;">
                                <img src="./code/results/fft_result.jpg" alt="hybrid_fft"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Hybrid image FFT</div>
                            </div>
                        </div>
                    </div>
                    <div class="vb">
                        <h3>Additional Hybrid Images</h3>
                        <div class="hb">
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/original_sakiko.png" alt="sakiko_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Sakiko original</div>
                            </div>
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/original_misumi.png" alt="misumi_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Misumi original</div>
                            </div>

                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/hybird_sakiko_misumi.png" alt="sakiko_misumi_hybrid"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Sakiko-Misumi hybrid</div>
                            </div>
                        </div>
                        <div class="hb">
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/original_trump.png" alt="trump_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Trump original</div>
                            </div>
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/original_putin.png" alt="putin_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Putin original</div>
                            </div>

                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/hybird_trump_putin.png" alt="trump_putin_hybrid"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Trump-Putin hybrid</div>
                            </div>
                        </div>
                        <div class="hb">
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/original_whitehouse.png" alt="whitehouse_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Whitehouse original</div>
                            </div>
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/original_tiananmen.png" alt="tiananmen_original"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Tiananmen original</div>
                            </div>
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/results/hybird_whitehouse_tiananmen.png"
                                    alt="whitehouse_tiananmen_hybrid"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Whitehouse-Tiananmen hybrid</div>
                            </div>
                        </div>
                    </div>
                    <p style="margin-top: 1em; color: #555;">
                        <strong>How it works:</strong>
                        The technique involves creating a low-pass filtered version of one image (preserving
                        low-frequency content)
                        and a high-pass filtered version of another image (preserving high-frequency content).
                        These are then combined to form the hybrid image. When viewed up close, the high-frequency
                        content dominates
                        perception, while at a distance, the low-frequency content becomes more apparent.
                    </p>

                    <details style="margin-top:0.7em;">
                        <summary
                            style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                            Show Code</summary>
                        <pre
                            style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                        <code class="language-python">
def gaussconvolve2d(array, sigma):
    # Generate Gaussian filter
    delta = int(np.ceil(6 * sigma))
    if delta % 2 == 0:
        delta += 1
    X, Y = np.meshgrid(np.arange(-delta//2+1, delta//2+1), 
                       np.arange(-delta//2+1, delta//2+1))
    gF = np.exp(-(X**2 + Y**2) / (2 * sigma**2))
    gF = gF / np.sum(gF)
    
    # Convolve with Gaussian filter
    result = signal.convolve2d(array, gF, 'same')
    return result

def low_pass(image, sigma):
    # Apply low pass filter to each channel
    if len(image.shape) == 3:
        low_passed = np.zeros_like(image)
        for i in range(image.shape[2]):
            low_passed[:,:,i] = gaussconvolve2d(image[:,:,i], sigma)
        return low_passed
    else:
        return gaussconvolve2d(image, sigma)

def high_pass(image, sigma):
    # High pass = original - low pass
    return image - low_pass(image, sigma)

def hybrid_image(im1, im2, sigma1, sigma2):
    # Create hybrid image by combining low frequency of im1 and high frequency of im2
    low_freq = low_pass(im1, sigma1)
    high_freq = high_pass(im2, sigma2)
    
    # Combine the images
    hybrid = low_freq + high_freq
    
    # Clip values to valid range [0, 1]
    hybrid = np.clip(hybrid, 0, 1)
    
    return hybrid</code>
                        </pre>
                    </details>
                </div>
            </div>
        </section>

        <section style="margin-bottom: 2.5rem;">
            <h2 style="color:#2a5db0; text-align:center; margin-bottom:1.2rem; letter-spacing:1px; font-size:2.1rem;">
                Part 3: Multi-resolution Blending</h2>
            <div
                style="color:#2d3540; font-size:1.13rem; max-width:900px; margin:0 auto 2.2rem auto; line-height:1.85; background:linear-gradient(90deg,#fafdff 60%,#eaf1fa 100%); border-radius:18px; padding:1.5rem 2.2rem; box-shadow:0 4px 24px rgba(58,123,213,0.10); border-left:6px solid #3a7bd5;">
                <div style="margin-bottom:1.5em;">
                    <span style="font-weight:600; color:#3a7bd5;">Part 3.1: Gaussian and Laplacian Stacks</span><br>
                    <span style="color:#444;">In this part we implement Gaussian and Laplacian stacks. The difference
                        between a stack and a pyramid is that in each level of the pyramid the image is downsampled, so
                        that the result gets smaller and smaller. In a stack the images are never downsampled so the
                        results are all the same dimension as the original image.</span>

                    <div class="vb">
                        <h3>Gaussian Stack</h3>
                        <div class="hb">
                            <div style="text-align:center; width: 100%;">
                                <img src="./code/results/blending_gaussian_stack.png" alt="Gaussian Stack"
                                    style="max-width:800px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Gaussian Stack Visualization</div>
                            </div>
                        </div>
                    </div>

                    <div class="vb">
                        <h3>Laplacian Stack</h3>
                        <div class="hb">
                            <div style="text-align:center; width: 100%;">
                                <img src="./code/results/blending_laplacian_stack.png" alt="Laplacian Stack"
                                    style="max-width:800px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Laplacian Stack Visualization</div>
                            </div>
                        </div>
                    </div>

                    <details style="margin-top:0.7em;">
                        <summary
                            style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                            Show Code</summary>
                        <pre
                            style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                        <code class="language-python">
def gaussian_stack(img, num_levels=10, kernel_size=11, sigma=3):
    img = img.astype(np.float32)
    g_stack = [img]
    gaussian_kernel = cv2.getGaussianKernel(kernel_size, sigma)
    gaussian_kernel = gaussian_kernel @ gaussian_kernel.T

    for i in range(1, num_levels):
        blurred = cv2.filter2D(g_stack[-1], -1, gaussian_kernel)
        g_stack.append(blurred)
    return g_stack

def laplacian_stack(g_stack):
    l_stack = []
    for i in range(len(g_stack) - 1):
        lap = g_stack[i] - g_stack[i + 1]
        l_stack.append(lap)
    l_stack.append(g_stack[-1])
    return l_stack</code>
                        </pre>
                    </details>
                </div>
                <div style="margin-bottom:1.5em;">
                    <span style="font-weight:600; color:#3a7bd5;">Part 3.2: Blending Process</span><br>
                    <span style="color:#444;">Here we demonstrate the multiresolution blending process using the
                        Gaussian and Laplacian stacks. We blend two images (Coke and Sprite) using a mask to create a
                        seamless transition.</span>

                    <div class="vb">
                        <h3>Input Images</h3>
                        <div class="hb">
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/imgs/sprite.png" alt="Sprite"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Sprite Image</div>
                            </div>
                            <div style="text-align:center; width: 45%;">
                                <img src="./code/imgs/coke.png" alt="Coke"
                                    style="max-width:320px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Coke Image</div>
                            </div>
                        </div>
                    </div>

                    <div class="vb">
                        <h3>Blending Process by Levels</h3>
                        <div class="hb">
                            <div style="text-align:center; width: 100%;">
                                <img src="./code/results/blending_proccessing.png" alt="Blending Process"
                                    style="max-width:800px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Blending Process Visualization</div>
                            </div>
                        </div>
                    </div>

                    <div class="vb">
                        <h3>Final Blended Image</h3>
                        <div class="hb">
                            <div style="text-align:center; width: 100%;">
                                <img src="./code/results/blending_result.png" alt="Blending Result"
                                    style="max-width:400px; width:100%; border-radius:12px; box-shadow:0 2px 12px rgba(58,123,213,0.12);">
                                <div style="margin-top: 0;color:#555;">Final Blended Image</div>
                            </div>
                        </div>
                    </div>

                    <details style="margin-top:0.7em;">
                        <summary
                            style="cursor:pointer; font-weight:500; color:#2a5db0; background-color: rgb(236, 244, 250);">
                            Show Code</summary>
                        <pre
                            style="background:#23272e;font-size:0.9rem;padding:0.5em 1em;border-radius:10px;overflow-x:auto;line-height:1.7;margin:0.7em 0 0 0;box-shadow:0 2px 8px rgba(58,123,213,0.08);">
                        <code class="language-python">
def get_masks(shape, num_levels=8):
    h, w, c = shape
    masks = []
    start = end = w // 2 - 10
    transition = int(w * 0.015)
    for i in range(num_levels):
        mask = np.zeros((h, w, c), dtype=np.float32)
        mask[:, :start, :] = 0
        mask[:, end:, :] = 1
        if end > start:
            gradient = np.linspace(0, 1, end - start)
            mask[:, start:end, :] = gradient[None, :, None]
        masks.append(mask)
        start = max(start - transition, 0)
        end = min(end + transition, w)
    return masks

# Blending process
img1 = cv2.imread('./imgs/sprite.png')
img2 = cv2.imread('./imgs/coke.png')
img1 = cv2.resize(img1, (img1.shape[1]//2, img1.shape[0]//2))
img2 = cv2.resize(img2, (img2.shape[1]//2, img2.shape[0]//2))

g1 = gaussian_stack(img1)
g2 = gaussian_stack(img2)
l1 = laplacian_stack(g1)
l2 = laplacian_stack(g2)

masks = get_masks(img1.shape, num_levels=len(l1))

imgs1 = [l1[i] * masks[i] for i in range(len(l1))]
imgs2 = [l2[i] * (1 - masks[i]) for i in range(len(l2))]
results = [imgs1[i] + imgs2[i] for i in range(len(imgs1))]

result = np.sum(np.array(results), axis=0)
result = np.clip(result, 0, 255).astype(np.uint8)</code>
                        </pre>
                    </details>
                </div>
            </div>
        </section>



    </div>
    <script src="./main.js"></script>
    <script>hljs.highlightAll();</script>
</body>

</html>